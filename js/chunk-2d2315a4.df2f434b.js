(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2315a4"],{efd1:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Content",[s("Row",[s("Col",{attrs:{span:"16"}},[s("Content",{staticStyle:{padding:"5px"}},[s("Card",[s("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":80}},[s("FormItem",{attrs:{label:"标题",prop:"title"}},[s("Input",{attrs:{placeholder:"title"},model:{value:t.formValidate.title,callback:function(e){t.$set(t.formValidate,"title",e)},expression:"formValidate.title"}})],1),s("FormItem",{attrs:{label:"主题",prop:"keyword"}},[s("Input",{attrs:{placeholder:"keyword"},model:{value:t.formValidate.keyword,callback:function(e){t.$set(t.formValidate,"keyword",e)},expression:"formValidate.keyword"}}),s("p",[s("Icon",{attrs:{type:"ios-information-circle-outline"}}),t._v("可使用指定格式关键词关联页面\n\t\t\t\t\t\t")],1)],1)],1)],1)],1)],1),s("Col",{attrs:{span:"8"}},[s("Sider",{attrs:{width:"100%","hide-trigger":""}},[s("div",{staticStyle:{"background-color":"#f8f8f9",padding:"5px"}},[s("Card",{staticClass:"DiscussCard"},[s("p",{attrs:{slot:"title"},slot:"title"},[t._v("新建讨论")]),s("p",{attrs:{slot:"extra"},slot:"extra"},[s("Button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("提交")])],1),s("Table",{attrs:{"show-header":!1}})],1)],1)])],1)],1),s("Card",[s("mavon-editor",{ref:"editor",staticStyle:{"min-height":"600px"},on:{imgAdd:t.$imgAdd,save:t.saveContent},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)],1)},i=[],o={name:"DiscussEdit",data(){return{btnLoading:!1,formValidate:{title:"",keyword:""},ruleValidate:{title:[{required:!0,message:"标题不能为空！",trigger:"blur"}],keyword:[{required:!0,message:"主题不能为空！",trigger:"blur"}]},content:""}},mounted(){this.formValidate.keyword=this.$route.query["keyword"]},methods:{saveContent:function(){if(""==this.formValidate.title)this.$Message.error("请先输入标题！");else if(""==this.formValidate.keyword)this.$Message.error("请先输入主题！");else if(this.content.length<1)this.$Message.error("内容不能为空!");else{this.$Spin.show();var t=new URLSearchParams;t.append("user_id",this.$store.state.loginInfo.user_id),t.append("token",this.$store.state.loginInfo.token),t.append("title",this.formValidate.title),t.append("keyword",this.formValidate.keyword),t.append("content",this.content),this.btnLoading=!0,axios.post(this.$store.state.API_ROOT+"discuss/add",t).then(t=>{t.data.data.is_ok?(this.$Message.success("保存成功！"),this.$router.push("/discuss/"+t.data.data.discuss_id+"/edit")):this.$Message.error("保存失败！"),this.btnLoading=!1,this.$Spin.hide()}).catch(function(t){this.$Message.error("保存失败！"),this.btnLoading=!1,this.$Spin.hide()})}},handleSubmit(t){this.$refs[t].validate(t=>{if(t)if(this.content.length<1)this.$Message.error("内容不能为空!");else{this.$Spin.show(),this.btnLoading=!0;var e=new URLSearchParams;e.append("user_id",this.$store.state.loginInfo.user_id),e.append("token",this.$store.state.loginInfo.token),e.append("title",this.formValidate.title),e.append("keyword",this.formValidate.keyword),e.append("content",this.content),axios.post(this.$store.state.API_ROOT+"discuss/add",e).then(t=>{this.$Spin.hide(),t.data.data.is_ok?(this.$Message.success("保存成功！"),this.$router.push("/discuss/"+t.data.data.discuss_id+"/edit")):this.$Message.error("保存失败！"),this.btnLoading=!1}).catch(function(t){this.$Spin.hide(),this.btnLoading=!1,this.$Message.error("保存失败！")})}else this.$Message.error("请检查输入!")})},$imgAdd(t,e){this.$Spin.show(),axios.get(this.$store.state.API_ROOT+"upload/token").then(s=>{this.uploadToken=s.data.data.token;var a=new URLSearchParams;a.append("token",this.uploadToken),a.append("file",e);var i=new FormData;i.append("token",this.uploadToken),i.append("file",e),axios.post("https://upload.qiniup.com",i).then(e=>{this.$refs.editor.$img2Url(t,this.$store.state.CDN_ROOT+e.data.key),this.$Spin.hide(),this.$Message.success("图片上传成功！")}).catch(function(t){console.log(t)})}).catch(function(t){console.log(t)})}}},r=o,n=s("2877"),d=Object(n["a"])(r,a,i,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d2315a4.df2f434b.js.map